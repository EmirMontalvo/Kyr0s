@use '../shared/loading.scss';

.calendar-container {
    display: flex;
    gap: 20px;
    height: calc(100vh - 100px); // Adjust based on toolbar height

    @media (max-width: 800px) {
        flex-direction: column;
        height: auto;
    }
}

.sidebar {
    flex: 0 0 300px;

    @media (max-width: 800px) {
        flex: 0 0 auto;
        width: 100%;
    }

    .datepicker-card {
        padding: 10px;
    }

    .branch-filter {
        margin-top: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        padding: 0 10px;

        .filter-btn {
            width: 100%;
            border-radius: 8px;
        }

        .selected-branch {
            font-size: 14px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 5px;
            margin: 0;
            text-align: center;
            justify-content: center;

            mat-icon {
                font-size: 18px;
                width: 18px;
                height: 18px;
                color: #2196f3;
            }
        }
    }
}

.main-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;

    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding: 10px; // Add padding to prevent hover clipping

        h2 {
            margin: 0;
            text-transform: capitalize;
            font-size: 1.5rem;
        }

        // Remove shadow from FAB button
        button[mat-fab] {
            box-shadow: none !important;
            border: 1px solid #e0e0e0;
        }

        @media (max-width: 600px) {
            flex-direction: column;
            gap: 10px;
            align-items: stretch;

            button {
                width: 100%;
            }
        }
    }
}

.citas-list {
    flex: 1;
    overflow-y: auto;
    padding: 10px; // Add padding to all sides to prevent shadow clipping
}

.empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 50px;
    color: #888;

    mat-icon {
        font-size: 48px;
        width: 48px;
        height: 48px;
        margin-bottom: 10px;
    }
}

.cita-card {
    display: flex;
    flex-direction: row;
    padding: 15px;
    margin-bottom: 10px;
    border-left: 5px solid transparent;

    @media (max-width: 600px) {
        flex-direction: column;
        gap: 10px;
    }

    &.en-proceso {
        border-left-color: #4caf50; // Green
        background-color: #f1f8e9;
    }

    .time-column {
        display: flex;
        flex-direction: column;
        justify-content: center;
        min-width: 80px;
        font-weight: bold;
        color: #555;
        border-right: 1px solid #eee;
        margin-right: 15px;
        padding-right: 15px;

        @media (max-width: 600px) {
            flex-direction: row;
            justify-content: space-between;
            border-right: none;
            margin-right: 0;
            padding-right: 0;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 10px;
        }

        .end-time {
            font-size: 0.8em;
            color: #999;
        }
    }

    .info-column {
        flex: 1;

        h3 {
            margin: 0 0 5px 0;
            font-size: 1.1em;
        }

        .services {
            margin: 0 0 5px 0;
            color: #666;
        }

        .price {
            margin: 0;
            font-weight: bold;
            color: #2196f3; // Brand Blue
        }

        .employee {
            margin: 0;
            font-size: 0.9em;
            color: #888;
            display: flex;
            align-items: center;
            gap: 5px;
        }
    }

    .status-column {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 10px;

        @media (max-width: 600px) {
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            text-transform: uppercase;
            font-weight: bold;

            &.confirmada,
            &.pendiente {
                background-color: #e3f2fd;
                color: #1976d2;
            }

            &.completada {
                background-color: #e8f5e9;
                color: #388e3c;
            }

            &.cancelada {
                background-color: #ffebee;
                color: #d32f2f;
            }

            &.en_proceso {
                background-color: #fff3e0;
                color: #f57c00;
            }
        }

        .actions {
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.2s;

            // Always show actions on touch devices or small screens
            @media (hover: none),
            (max-width: 600px) {
                opacity: 1;
            }
        }
    }

    &:hover .status-column .actions {
        opacity: 1;
    }
}

// Ensure selected date is visible with custom theme
::ng-deep .mat-calendar-body-selected {
    background-color: #2196f3 !important; // Brand Blue
    color: white !important;
}

// Highlight today's date with the same blue, even if not selected
::ng-deep .mat-calendar-body-today {
    background-color: #2196f3 !important; // Brand Blue
    color: white !important;
    border: none !important;
    border-radius: 50%;
}

// Fix for "Previous/Next month" text appearing on hover
::ng-deep .mat-calendar-controls {

    .mat-calendar-previous-button,
    .mat-calendar-next-button {
        overflow: hidden !important;
        font-size: 0 !important; // Hide text

        // Ensure the icon remains visible and sized correctly
        .mat-icon,
        svg {
            font-size: 24px !important;
            display: block !important;
        }

        // Aggressively hide accessibility spans
        .cdk-visually-hidden {
            display: none !important;
            visibility: hidden !important;
        }
    }
}